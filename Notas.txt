-- TODO --
- contrato vapaeetokens
  - agregar los fees depositados a la tabla ordertables
  - me falta resolver el problema de desuscribir al usuario que ya no tiene depósitos: depusers depuserstable(get_self(), get_self().value);
- website
  - Trade
    - manejar errores cuando se genera una órden
    - Gráfica
    - Timezone: que el usuario elija su timezone para mostrar mejor los horarios de las transacciones en el historial
    - cuando se genera una transacción, el historial se actualiza y debería resaltarse temporalmente la reciente transacción.
  - Account
    - órdenes vigentes
  - ambientar todo para deployar en vapaee.io ?
    - home page (logo, textos, lista de tokens más relevantes)
    - comprar dominio
    - resolver https
    - PWA?


-- TODO NEXT !! --
- account:
  - si el account es "guest" no mostrar los paneles

-- TODO MUST --
- un botón para vender el 100%
- min trade: hay que asegurar que la orden cumpla un mínimo.
- Gráfica
- home:
  - logos
  - textos
  - tokens principales
- publishing
  - dominio vapaee.io
  - certificado

-- TODO bugs --
- el componente panel-wallet en la página trade se puede hacer click y aparece el cmapo para retirar. No debería aparecer nada.
- se sabe que si se hace múitiple match con todo el depósito, puede que no haya suficiente para la comisión y falle toda la transacción.
- cuando toco una orden que no es la primera, el total se calcula sin tener el cuenta los escalones de diferentes precios.

-- TODO detalles --
- cambiar el contrato para que, intente cobrarte con ACORNS primero y con TLOS después. Si no puede, que te saque un porcentaje de tus ganancias.
- la lista de tokens debería tener el summary (vol, price, change24h)
- debería usarse el api para saber cuanto vale el TLOS y hacer regla de tres para saber cuanto vale cada token
- listar el precio de cada token en USD, sumar todo y mostrar el TOTAl en la seccion account
- hacer que en la sección account se pueda explorar el estado de cuenta de un account sin tener que estar logueado
- cambiar la implementación actual del order-form que lista las órdenes y usar el actal panel-user-orders





-- TODO PARTE 2: Working proposal --
- Gráfica
- que se vena todo en dólares
- subastas
- vapaee tokens - pasive income eco
- better UI






-- TODO (futuro) vapaeetokens --
- Subasta: Implementar en el contrato la Subasta
  - tengo que poder vender M (de los N XXX tokens depositados) cada T tiempo al mejor postor que page con ZZZ, hasta agotar stock.
    auction1(owner, receiver, "N.0000 XXX", "ZZZ", "M.0000 XXX", interval_time)
    auction2(owner, receiver, "N.0000 XXX", "ZZZ", total_time)
    doauction(): ejecuta el primer auction si está vencido. lo puede ejecutar cualqueira.
  - Table auction: scope contract
    {
        uint64_t id;
        name owner;
        name receiver;
        asset portion;      // XXX to sell each interval
        asset remaining;    // XXX
        asset collected;    // ZZZ
        uint64_t interval;  // interval time
        uint64_t next;      // next expire time
        uint64_t timer;     // last timer expire time
    }
  - ajustar el htransfer para que se fije si hay algún auction para ejecutar.
    - Se fija en la tabla de auctions ordenando por next.
    - Si el primero ya está vencido, lo ejecuta y agenda el siguiente si no está agendado ya.
    - si el primero no está vencido, se fija si está agendado comparando timer con next.
      Si timer < next => reagendar y actualizar timer





---------------------------------------------------------------------
---------------------------------------------------------------------
-- Mainnet ----------------------------------------------------------
---------------------------------------------------------------------
cd /var/www/eosio-angular-app/contracts/vapaeetokens
telosmain set contract vapaeetokens $PWD -p vapaeetokens@active
telosmain set account permission vapaeetokens active '{"threshold": 1,"keys": [{"key": "EOS8MPwGHuGSHSfBp3HAWsrHDotAqp9ZPShBvNcGDpcmNNa5h8y1Q","weight": 1}],"accounts": [{"permission":{"actor":"vapaeetokens","permission":"eosio.code"},"weight":1}]}' owner -p vapaeetokens
telosmain push action vapaeetokens addtoken '["eosio.token","TLOS",4,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens create '["vapaeetokens","500000000.0000 CNT"]' -p vapaeetokens@active
telosmain push action vapaeetokens setsnapshot '["snapshots.tf",1,"CNT",0,0,10000,0,"CNT Token Airdrop - Cards & Tokens - http://cardsandtokens.com"]' -p vapaeetokens@active

telosmain set contract boardgamebox $PWD -p boardgamebox@active




echo "-- register CNT --" 
telosmain push action vapaeetokens addtoken '["vapaeetokens","CNT",4,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens updatetoken '["CNT", "Cards & Tokens", "http://cardsandtokens.com", "/assets/logos/cnt.svg", "/assets/logos/cnt-lg.svg", true]' -p vapaeetokens@active
echo "-- register TLOS --" 
telosmain push action vapaeetokens addtoken '["eosio.token","TLOS",4,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens updatetoken '["TLOS", "Telos", "https://telosfoundation.io", "/assets/logos/telos.png", "/assets/logos/telos-lg.png", true]' -p vapaeetokens@active
echo "-- register VIITA --" 
telosmain push action vapaeetokens addtoken '["viitasphere1","VIITA",4,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens updatetoken '["VIITA", "Viitasphere", "https://viitasphere.com", "/assets/logos/viitasphere.png", "/assets/logos/viitasphere-lg.png", true]' -p vapaeetokens@active
echo "-- register VIICT --" 
telosmain push action vapaeetokens addtoken '["viitasphere1","VIICT",0,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens updatetoken '["VIICT", "Viitasphere", "https://viitasphere.com", "/assets/logos/viitasphere.png", "/assets/logos/viitasphere-lg.png", false]' -p vapaeetokens@active
echo "-- register QBE --" 
telosmain push action vapaeetokens addtoken '["qubicletoken","QBE",4,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens updatetoken '["QBE", "Qubicles", "https://fenero.io/qubicles", "/assets/logos/qbe.png", "/assets/logos/qbe-lg.png", true]' -p vapaeetokens@active
echo "-- register ACORN --" 
telosmain push action vapaeetokens addtoken '["acornaccount","ACORN",4,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens updatetoken '["ACORN", "ACORN", "http://acorns.fun", "/assets/logos/acorn.svg", "/assets/logos/acorn-lg.png", true]' -p vapaeetokens@active
echo "-- register EDNA --" 
telosmain push action vapaeetokens addtoken '["ednazztokens","EDNA",4,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens updatetoken '["EDNA", "EDNA", "https://github.com/EDNA-LIFE", "/assets/logos/edna.png", "/assets/logos/edna-lg.png", true]' -p vapaeetokens@active
echo "-- register TEACH --" 
telosmain push action vapaeetokens addtoken '["teachology14","TEACH",4,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens updatetoken '["TEACH", "Teachology", "http://teachology.io", "/assets/logos/teach.svg", "/assets/logos/teach-lg.png", true]' -p vapaeetokens@active
echo "-- register ROBO --" 
telosmain push action vapaeetokens addtoken '["proxibotstkn","ROBO",4,"vapaeetokens"]' -p vapaeetokens@active
telosmain push action vapaeetokens updatetoken '["ROBO", "Proxibots", "https://proxibots.io", "/assets/logos/proxibots.png", "/assets/logos/proxibots-lg.png", true]' -p vapaeetokens@active




---------------------------------------------------------------------
---------------------------------------------------------------------
-- Testnet ----------------------------------------------------------
---------------------------------------------------------------------
telostest set contract vapaeetokens $PWD -p vapaeetokens@active
telostest push action vapaeetokens addtoken '["eosio.token","TLOS",4,"vapaeetokens"]' -p vapaeetokens@active
telostest push action vapaeetokens create '["vapaeetokens","500000000.0000 CNT"]' -p vapaeetokens@active
telostest push action vapaeetokens setsnapshot '["setsnapshot",1,"CNT",0,0,10000,0,"CNT Token Airdrop - Cards & Tokens - http://cardsandtokens.com"]' -p vapaeetokens@active




-------- TELOS SNAPSHOTS --------
telostest get table snapsnapsnap 1 snapshots --lower viterbotelos
telosmain get table snapshots.tf 1 snapshots --lower viterbotelos
cleos --url https://telos.eos.barcelona get table snapshots.tf 1 snapshots --lower geytinzygige







-- TODO futuro (contrato BG-BOX) ---
--------- Casos de uso Basico (BG-BOX) -----------
-- All --
- Register author 

-- APPs --
- Registro de una app (app_name, inventory, deposit)   // C&T
- Registro de un item Spec                   // Card, Envelop, Box
- Registro de container Spec                 // Album, Envelop, Box

-- Publisher --
- Registro de un Item Asset                  // openmic-w107-orrslaw-not-sorry: publicación de una carta específica
- Registro de un Container Asset             // openmic-100-weeks: publicación de un album concreto
- Issue copies of an Item Asset              // Crea N copias de una carta, que se sumarán al supply existente sin pasar de un máximo

-- User --
-- Swap units places (container / position)  // move cards in the inventory or album
-- use container                             // issues an instance of Container Asset
-- transfer units                            // give cards to someone else


Las aplicaciones deben ser registradas dando el account del contrato inteligente que cumple con un api para poder avisarle cada evento.
De esta manera el BG-Box se encarga con las reglas de Items y Containers Genéricos mientras que el el handler se encarga de reglas más específicas de la app.
Por ejemplo, se pueden exigir comisiones por cada evento, cumplir con mínimos o máximos, disparar otras acciones como cobrar impuesto, etc.


--------- Casos de uso Medio (BG-BOX) -----------
-- market 
  -- order units                               // creates an order to buy or sell any amount of owning copies of the same card
  -- cancel order                              // cancel previously created order
-- multiple authorship
  - hacer otra tabla donde el scope sea el user y que ahi se diga cuanto tiene cada usuario de authorship de cada item.
    por lo general vos podés hacer una carta y para esa carta va a decir que vos tenés el 100% y el resto del mundo 0%.
    pero pueden haber varias partes productoras de un mismo contenido y se arregla de antemano dividir el authorship en partes A% B% y C% dependiendo de la participación de cada uno.
  - cada vez que hay una compra o venta de un item con multimple authorship hay que dividir las ganancias respentado los porcentajes A% B% y C%
